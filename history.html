<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#121212">
    <link rel="icon" type="image/png" sizes="64x64" href="assets/logo-small-64.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/logo-small-256.png">
    <link rel="manifest" href="manifest.json">
    <title>GymLog - Historia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'neon-green': '#10b981',
                        'dark-bg': '#121212',
                        'dark-card': '#1e1e1e',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
    </style>
</head>
<body class="bg-dark-bg text-gray-100 min-h-screen pb-20">
    <div class="max-w-lg mx-auto p-4 sm:p-6">
        <!-- Header -->
        <header class="flex items-center justify-between mb-8 pt-4">
            <div class="flex items-center gap-3">
                <img src="assets/logo.png" alt="GymLog" class="h-10 w-auto">
            </div>
            <div class="flex items-center gap-2">
                <span id="totalCount" class="text-sm text-gray-500 font-bold">0 trening√≥w</span>
            </div>
        </header>

        <!-- Category Filter -->
        <div class="mb-4">
            <div class="flex gap-2 overflow-x-auto pb-2">
                <button 
                    onclick="filterByType('all')"
                    id="filterAll"
                    class="category-btn px-3 py-1.5 rounded-lg font-semibold text-xs whitespace-nowrap transition-all bg-gray-800 text-neon-green"
                >
                    Wszystkie
                </button>
                <button 
                    onclick="filterByType('weighted')"
                    id="filterWeighted"
                    class="category-btn px-3 py-1.5 rounded-lg font-semibold text-xs whitespace-nowrap transition-all bg-gray-800 text-gray-500"
                >
                    Ciƒô≈ºar
                </button>
                <button 
                    onclick="filterByType('bodyweight')"
                    id="filterBodyweight"
                    class="category-btn px-3 py-1.5 rounded-lg font-semibold text-xs whitespace-nowrap transition-all bg-gray-800 text-gray-500"
                >
                    Masy
                </button>
                <button 
                    onclick="filterByType('timed')"
                    id="filterTimed"
                    class="category-btn px-3 py-1.5 rounded-lg font-semibold text-xs whitespace-nowrap transition-all bg-gray-800 text-gray-500"
                >
                    Czas
                </button>
            </div>
        </div>

        <!-- Search Filter -->
        <div class="mb-6">
            <input 
                type="text" 
                id="searchInput" 
                placeholder="Szukaj ƒáwiczenia..."
                class="w-full bg-dark-card border-2 border-gray-700 rounded-2xl py-3 px-5 text-base font-semibold focus:border-neon-green focus:outline-none transition-all placeholder:text-gray-600"
            >
        </div>

        <!-- History List -->
        <main>
            <div id="historyList" class="space-y-3">
                <!-- Populated by JS -->
            </div>
        </main>
    </div>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-dark-card border-t border-gray-800 z-50">
        <div class="max-w-lg mx-auto flex">
            <a href="index.html" class="flex-1 flex flex-col items-center justify-center py-4 text-gray-500 hover:text-gray-400 transition-colors">
                <img src="assets/dumbbell-solid-full.svg" alt="Trening" class="w-7 h-7 mb-1" style="filter: brightness(0) saturate(100%) invert(35%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(95%) contrast(90%);">
                <span class="text-xs font-bold">TRENING</span>
            </a>
            <a href="stats.html" class="flex-1 flex flex-col items-center justify-center py-4 text-gray-500 hover:text-gray-400 transition-colors">
                <img src="assets/chart-simple-solid-full.svg" alt="Statystyki" class="w-7 h-7 mb-1" style="filter: brightness(0) saturate(100%) invert(35%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(95%) contrast(90%);">
                <span class="text-xs font-bold">STATYSTYKI</span>
            </a>
            <a href="profile.html" class="flex-1 flex flex-col items-center justify-center py-4 text-gray-500 hover:text-gray-400 transition-colors">
                <svg class="w-7 h-7 mb-1" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
                <span class="text-xs font-bold">PROFIL</span>
            </a>
        </div>
    </nav>

    <!-- Edit Modal -->
    <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4">
        <div class="bg-dark-card border-2 border-gray-700 rounded-2xl p-6 max-w-md w-full animate-slide-in max-h-[90vh] overflow-y-auto">
            <h2 class="text-xl font-black text-neon-green mb-6">EDYTUJ SERIƒò</h2>
            
            <form id="editForm" class="space-y-4">
                <input type="hidden" id="editId">
                
                <!-- Type Selector -->
                <div>
                    <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Typ ƒáwiczenia</label>
                    <div class="grid grid-cols-3 gap-2">
                        <button 
                            type="button" 
                            onclick="selectEditType('weighted')"
                            id="editTypeWeighted"
                            class="edit-type-btn py-2 px-3 rounded-lg font-bold text-xs transition-all border-2 border-neon-green bg-neon-green/20 text-neon-green"
                        >
                            üèãÔ∏è Ciƒô≈ºar
                        </button>
                        <button 
                            type="button"
                            onclick="selectEditType('bodyweight')"
                            id="editTypeBodyweight"
                            class="edit-type-btn py-2 px-3 rounded-lg font-bold text-xs transition-all border-2 border-gray-700 bg-dark-bg text-gray-400"
                        >
                            üí™ Masy
                        </button>
                        <button 
                            type="button"
                            onclick="selectEditType('timed')"
                            id="editTypeTimed"
                            class="edit-type-btn py-2 px-3 rounded-lg font-bold text-xs transition-all border-2 border-gray-700 bg-dark-bg text-gray-400"
                        >
                            ‚è±Ô∏è Czas
                        </button>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-400 uppercase mb-2">ƒÜwiczenie</label>
                    <input 
                        type="text" 
                        id="editExercise" 
                        required
                        maxlength="40"
                        pattern="[^<>\"'`]*"
                        title="Nazwa ƒáwiczenia (max 40 znak√≥w)"
                        class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                    >
                </div>
                
                <!-- Weighted Fields -->
                <div id="editWeightedFields">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Ciƒô≈ºar (kg)</label>
                            <input 
                                type="number" 
                                id="editWeight" 
                                step="0.5"
                                class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                            >
                        </div>
                        
                        <div>
                            <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Powt√≥rzenia</label>
                            <input 
                                type="number" 
                                id="editReps" 
                                class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                            >
                        </div>
                    </div>
                </div>
                
                <!-- Bodyweight Fields -->
                <div id="editBodyweightFields" class="hidden">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Powt√≥rzenia</label>
                            <input 
                                type="number" 
                                id="editBwReps" 
                                class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Dodany ciƒô≈ºar (kg)</label>
                            <input 
                                type="number" 
                                id="editAddedWeight" 
                                step="0.5"
                                value="0"
                                class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                            >
                        </div>
                    </div>
                </div>
                
                <!-- Timed Fields -->
                <div id="editTimedFields" class="hidden space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Czas (min)</label>
                            <input 
                                type="number" 
                                id="editDuration" 
                                step="0.1"
                                class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Dystans (km)</label>
                            <input 
                                type="number" 
                                id="editDistance" 
                                step="0.1"
                                class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                            >
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-400 uppercase mb-2">Wzniesienie (m)</label>
                        <input 
                            type="number" 
                            id="editElevation" 
                            step="1"
                            class="w-full bg-dark-bg border-2 border-gray-700 rounded-xl py-3 px-4 text-base font-semibold focus:border-neon-green focus:outline-none transition-all"
                        >
                    </div>
                </div>
                
                <div class="flex gap-3 mt-6">
                    <button 
                        type="button" 
                        onclick="closeEditModal()"
                        class="flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all"
                    >
                        ANULUJ
                    </button>
                    <button 
                        type="submit"
                        class="flex-1 bg-neon-green hover:bg-emerald-400 text-dark-bg font-bold py-3 rounded-xl transition-all"
                    >
                        ZAPISZ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast notification -->
    <div id="toast" class="hidden fixed top-6 left-1/2 -translate-x-1/2 bg-neon-green text-dark-bg px-6 py-3 rounded-full font-bold shadow-2xl z-50 animate-slide-in">
        ‚úì Zapisano!
    </div>

    <!-- Update notification -->
    <div id="updateNotification" class="hidden fixed bottom-24 left-1/2 -translate-x-1/2 bg-neon-green text-dark-bg px-6 py-4 rounded-2xl font-bold shadow-2xl z-50 max-w-sm animate-slide-in">
        <div class="flex items-center gap-3">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
            <div class="flex-1">
                <p class="text-sm">Dostƒôpna aktualizacja!</p>
                <p class="text-xs opacity-80">Kliknij aby od≈õwie≈ºyƒá</p>
            </div>
        </div>
    </div>
    
    <!-- Install Button -->
    <button 
        id="installButton"
        onclick="handleInstallClick()"
        class="fixed bottom-24 right-4 bg-neon-green text-dark-bg px-5 py-3 rounded-2xl font-bold shadow-2xl z-50 transition-all duration-300"
        style="display: none; opacity: 0;"
    >
        <div class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            <div class="text-left">
                <p class="text-sm leading-tight">Zainstaluj GymLog</p>
                <p class="text-xs opacity-75 leading-tight">na telefonie</p>
            </div>
            <div 
                onclick="event.stopPropagation(); closeInstallPrompt();"
                class="ml-2 p-1 hover:bg-dark-bg hover:bg-opacity-20 rounded-lg transition-colors cursor-pointer"
            >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </div>
        </div>
    </button>

    <!-- Scripts -->
    <script src="app.js"></script>
    <script src="install.js"></script>
    <script src="js/sw-manager.js"></script>
    <script src="js/history-page.js"></script>
</body>
</html>
